// 以下為含有漏洞的程式碼，請參考附註

contract IntegerOverflowMappingSym1 {
    // 狀態變數: map，儲存 key-value 配對
    mapping(uint256 => uint256) map;

    // 漏洞函式 init
    // 問題關鍵在於直接對 map[k] 執行減法操作，而未對 underflow 進行檢查
    // 當 map[k] 預設為 0 且 v 大於 0 時，將發生 Integer Underflow，導致數值變為極大值
    function init(uint256 k, uint256 v) public {
        map[k] -= v; // VULNERABLE: 此處未檢查 underflow，可能使 map[k] 從 0 underflow 到 2**256 - 1
    }
}
